INSERT INTO 51_DOTACION_FINAL ( Version, [G/L Fiscal Year], [Posting period], Type, LOAD, [Profit Center], [PC Description], Country, [Company Code], [Cost Center], [CC Description], [Responsible 1], [Responsible 2], [Responsible 3], [Responsible 4], [Functional area], Description, [Group], [Employee Nr], [Last Name], Name, [Employee Name], Gender, [Position], Position_TEXT, [Role Category], [Role Category Code], Status, Dotacion, Valor, [Employee subgroup], [ID number], Nationality, [Personnel area], [PA Text], birdate, [Joined Group], Separation, [Employment status] )
SELECT "R" & [YEAR ?] AS Version, [YEAR ?] AS [YEAR], [MONTH ?] AS [MONTH], "CTB" AS Type, 1 AS LOAD, dbo_34_Maestro_Ceco_Profit.Profit_Center AS [Profit Center], dbo_34_Maestro_Ceco_Profit.PC_Description AS [PC Description], dbo_34_Maestro_Ceco_Profit.Country, dbo_34_Maestro_Ceco_Profit.Company_Code AS [Company Code], [50_DOTACION].[Cost Centre] AS [Cost Center], dbo_34_Maestro_Ceco_Profit.CC_Description AS [CC Description], dbo_34_Maestro_Ceco_Profit.R1 AS [Responsible 1], dbo_34_Maestro_Ceco_Profit.R2 AS [Responsible 2], dbo_34_Maestro_Ceco_Profit.R3 AS [Responsible 3], dbo_34_Maestro_Ceco_Profit.R4 AS [Responsible 4], dbo_34_Maestro_Ceco_Profit.[Functional area], [dbo_49_Maestro functional area].Description, [dbo_49_Maestro functional area].Group, [50_DOTACION].[Employee Nr], [50_DOTACION].[Last Name], [50_DOTACION].[Known As], [Known As] & " " & [Last Name] AS [Employee Name], Mid([gender],1,1) AS SEXO, [50_DOTACION].Position, [50_DOTACION].Position_TEXT, [50_DOTACION].[Role Category], [50_DOTACION].[Role Category Code], "Vigente" AS Status, 1 AS Dotacion, 0 AS Valor, [50_DOTACION].[Employee subgroup], [50_DOTACION].[ID number], [50_DOTACION].Nationality, [50_DOTACION].[Personnel area], [50_DOTACION].[PA Text], [50_DOTACION].birdate, [50_DOTACION].[Joined Group], [50_DOTACION].Separation, [50_DOTACION].[Employment status]
FROM (50_DOTACION LEFT JOIN dbo_34_Maestro_Ceco_Profit ON [50_DOTACION].[Cost Centre] = dbo_34_Maestro_Ceco_Profit.Cost_Center) LEFT JOIN [dbo_49_Maestro functional area] ON dbo_34_Maestro_Ceco_Profit.[Functional Area] = [dbo_49_Maestro functional area].[Functional area];
